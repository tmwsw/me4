# Модель классификации комментариев по работе управляющей компании

## Описание проекта

Предварительно требуется подготовить исходные данные
Разработать модель классификации комментариев по работе управляющей
компании на категории:
Вопрос решен
Качество выполненной работы
Компетентность работника в общение
Не удовлетворен
Скорость выполненной работы
Не понравился результат
Не понравилось качество
Входные данные представляют собой набор комментариев с отметками 1 в
колонке соответствующей категории
Оцениваться результат будет метрикой ROC-AUC

## Цель

Построить модель, которая по тексту комментария автоматически определяет, какие из следующих аспектов работы управляющей компании были упомянуты положительно:
Вопрос решен
Качество выполненной работы
Компетентность работника в общение
Не удовлетворен
Скорость выполненной работы
Не понравился результат
Не понравилось качество

## Данные

Данные с комментариями и оценками пользователе:

- `разметка комментариев 2.csv` – изначальные данные.
- `Готовые данные.csv` – Размеченные данные для обучения модели.

## Методология

Для решения задачи использовались методы анализа временных рядов и машинного обучения. Основные этапы работы:

1. **Предобработка данных**: Разметка данных с помощью(Label-studio), удаление дубликатов.
2. **Модель прогнозирования**: разработка моделей (Logistic Regression, Random Forest, Linear SVC, CatBoostClassifier).

## Используемые технологии

- Python
- Jupyter Notebook
- Pandas
- Numpy
- Scikit-learn
- CatBoost
- Joblib
- Ast

## Данные

- `data/разметка комментариев 2` – Изначальные данные.
- `data/Готовые данные.csv` – Данные для обучения модели.
- `data/Данные в нужном формате.csv` – Данные обработанные в нужный формат для более простой работы в VS Code.
- `data/Лист Microsoft Excel.xlsx` – Преобразование данных через Excel для более удобного способоа добавления категориальных столбцов.

## Структура репозитория

```
ME4/
|--catboost_info
│-- data/
│   │-- Готовые данные.csv
│   │-- Данные в нужном формате.csv
│   │-- Лист Microsoft Excel.csv
│   │-- разметка комментариев 2.csv
│-- model
|   │-- logistic_model.pkl
|   │-- random_forest_model.pkl
|   |-- linear_svc_model.pkl
|   |-- catboost_model.pkl
|-- .gitignore
|-- processing_data.ipynb # Обработка данных
│-- training.ipynb # Обучение моделей
│-- README.md  # Текущий файл
│-- requirements.txt  # Список зависимостей
|-- самолет_интенсив3_арматура_группа5.pptx # Презентация для представление проекта
```

## Метрики модели Logistic Regression (Ежов)

Оценка качества модели на тестовой выборке:

- **Average ROC-AUC**: 0.797
- **Average F1**: 0.650


## Метрики модели Random Forest (Ежов)

Оценка качества модели на тестовой выборке:

- **Average ROC-AUC**: 0.744
- **Average F1**: 0.609

## Метрики модели Linear SVC (Марин)

Оценка качества модели на тестовой выборке:

- **Average ROC-AUC**: 0.797
- **Average F1**: 0.649

## Метрики модели CatBoostClassifier (Марин)

Оценка качества модели на тестовой выборке:

- **Average ROC-AUC**: 0.756
- **Average F1**: 0.632

## Запуск проекта

1. Клонировать репозиторий:
   ```sh
   git clone https://github.com/tmwsw/me4
   ```
2. Установить зависимости:
   ```sh
   pip install -r requirements.txt
   ```
3. Запустить `training.ipynb` для обучения модели.

## Выводы

В рамках проекта была разработана модель мульти-лейбл классификации, способная автоматически определять положительные аспекты работы управляющей компании по текстам комментариев жильцов.

Были решены следующие задачи:

Предобработка и очистка данных: удаление пустых и нерелевантных строк.

Векторизация текстов с помощью TF-IDF.

Стратифицированное разбиение данных с учётом мульти-лейбл структуры.

Обучение нескольких моделей, включая Logistic Regression и CatBoostClassifier.

Оценка качества модели с использованием метрики ROC-AUC по каждой категории.

Модель продемонстрировала адекватное качество на тестовой выборке, позволяя выявлять, затронуты ли в комментарии такие аспекты, как скорость реакции, качество выполнения заявки, работа сотрудников и пр.

## Контакты

Если у вас есть вопросы, предложения или замечания, свяжитесь со мной через [GitHub Issues](https://github.com/tmwsw/me4/issues).
